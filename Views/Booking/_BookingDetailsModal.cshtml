@using static AmiFlota.Utilities.Enums
@model AmiFlota.Models.ViewModels.BookingVM

<!-- Button trigger modal -->
<!-- Modal -->
<div class="modal fade" id="bookingDetailsModal" role="dialog" aria-labelledby="bookingDetailsModal" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">


            <form method="post" asp-controller="Booking" asp-action="_BookingDetailsModal" id="bookingDetailsModalForm">
                <div class="modal-header">
                    <h5 class="modal-title" id="bookingDetailsModalTitle">Booking details</h5>
                </div>

                @*//TODO Layout corrections*@
                <div class="modal-body">
                    <input type="hidden" asp-for="BookingStatus" value="@AmiFlota.Utilities.Enums.BookingStatus.Pending" />

                    @*  <div asp-validation-summary="ModelOnly" class="text-danger">*@
                    <div class="form-group row mb-2">
                        <div class="col-6 text-end col-form-label">
                            <label for="lblUserName">User Name: </label>
                        </div>
                        @if (User.IsInRole(UserRole.admin.ToString())
                        || User.IsInRole(UserRole.manager.ToString()))
                        {
                            <div class="col-6 text-center">
                                <select asp-for="UserId" class="form-control" placeholder="Choose booking user" id="search"></select>
                            </div>
                        }
                        else
                        {
                            <div class="col-6 text-center">
                                <label asp-for="UserName">@Model.UserName</label>
                                <input asp-for="UserName" type="hidden" />
                                <input asp-for="UserId" type="hidden" value="@Model.UserId">
                            </div>
                        }
                    </div>




                    <div class="form-group row mb-2">
                        <div class="col-6 text-end col-form-label">
                            <label asp-for="RegistrationNumber">Registration Number:</label>
                        </div>
                        <div class="col-6 text-center">
                            <label class="form-control">@Model.RegistrationNumber</label>
                            <input asp-for="RegistrationNumber" type="hidden"></>
                        </div>
                    </div>

                    <div class="form-group row mb-2">
                        <div class="col-6 text-end col-form-label">
                            <label asp-for="StartDate">Start date:</label>
                        </div>
                        <div class="col-6 text-center">
                            <label class="form-control">@Model.StartDate</label>
                            <input asp-for="StartDate" type="hidden"></>
                        </div>
                    </div>

                    <div class="form-group row mb-2">
                        <div class="col-6 text-end col-form-label">
                            <label asp-for="EndDate">End date:</label>
                        </div>
                        <div class="col-6 text-center">
                            <label class="form-control">@Model.EndDate</label>
                            <input asp-for="@Model.EndDate" type="hidden"></>
                        </div>
                    </div>


                    <div class="form-group row mb-2">
                        <div class="col-6 text-end col-form-label">
                            <label asp-for="Description">Destination:</> </label>
                        </div>
                        <div class="col-6 text-center">
                            <input asp-for="Description" class="form-control" id="Booking.Destination"></>
                            <span asp-validation-for="Description"></span>
                        </div>
                    </div>


                    <div class="form-group row mb-2">
                        <div class="col-6 text-end col-form-label">
                            <label asp-for="ProjectCost">Project:</label>
                        </div>
                        <div class="col-6 text-center">
                            <input asp-for="ProjectCost" class="form-control" id="Booking.ProjectCost"></>
                            <span asp-validation-for="ProjectCost"></span>
                        </div>
                    </div>


                    @*    </div>*@
                </div>

                <div class="modal-footer">
                    <div class="row align-items-center">
                        <button type="submit" id="btnBookCar" class="btn btn-success btn-book">Book</button>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>

<script>

    $(document).ready(function() {

    @*  $('#search').onchange(function() {
            var SelectedValue = ('#search').getValue();
            }); *@



    @*        var optionsTest = [
            { id: 1, title: 'Spectrometer', url: 'http://en.wikipedia.org/wiki/Spectrometers' },
            { id: 2, title: 'Star Chart', url: 'http://en.wikipedia.org/wiki/Star_chart' },
            { id: 3, title: 'Electrical Tape', url: 'http://en.wikipedia.org/wiki/Electrical_tape' }
            ];*@

                                                            var dtoUsers = [];

        $.ajax({
            url: routeURL + '/api/Users/GetAllUsers',
            type: 'GET',
            dataType: 'JSON',
            success: function(response) {
                if (response.status === 1) {
                    console.log(response.dataenum);
                    $.each(response.dataenum, function(i, data) {
                        dtoUsers.push({
                            id: data.id,
                            name: data.name
                        });
                    });
                    console.log(dtoUsers);
                    $('#search').selectize({
                        valueField: 'id',
                        labelField: 'name',
                        searchField: 'name',
                        options: dtoUsers
                    });
    @*$.notify(response.message, "success");*@
                                                                    }
                else {
                    $.notify(response.message, "error");
                }

            },
            error: function(xhr) {
                $.notify("Error", "error");
            }
        });


    @*       $('#search').selectize({
            valueField: 'id',
            labelField: 'title',
            searchField: 'title',
            options: optionsTest
            });*@



                                                    });
</script>